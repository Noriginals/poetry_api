<html>
    <head>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

        <!-- Latest compiled and minified JavaScript -->
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script>
            //if (!!window.EventSource) {
            //  var source = new EventSource('/');
            //  source.onmessage = function(e) {
            //    $("#data").text(e.data);
            //  }
            //}

            $(document).ready(function(){
                console.log('On load');
                $("#search").bind('submit', function (e) {
                    console.log('Event Fired');
                    e.preventDefault();
                    $("#data").text('');

                    var xhr = new XMLHttpRequest();
                    var url = "/";
                    var params = $('#search').serialize();
                    xhr.open("POST", url, true);

                    xhr.onprogress = function(){
                        console.log('------')
                        console.log(this.responseText);
                        console.log('------')
                        $("#data").html(this.responseText);
                    }
                    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                    xhr.send(params);

                });
            });

        </script>
        </head>
    <body>
        <div id='form'>
            <form id='search' method="POST" action="">
                {{ form.csrf_token }}
                <div>
                    <div>{{ form.styles.label }} {{ form.styles }}</div>
                    <div>{{ form.topics.label }} {{ form.topics }}</div>
                </div>

                <input type="submit" value="Search">
            </form>
        </div>
            <div class="list-group" id="data">No data</div>
    </body>
</html>
